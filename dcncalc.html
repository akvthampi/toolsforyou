<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <title>Indian Food Calorie Needs Calculator</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"/>
  <style>
    /* ========== Base & Theme (mirrors BMI app aesthetics) ========== */
    :root{
      --bg:#0f172a;
      --muted:#94a3b8;
      --text:#e2e8f0;
      --primary:#6366f1;
      --primary-600:#5558ec;
      --success:#22c55e;
      --warning:#f59e0b;
      --danger:#ef4444;
      --shadow:0 10px 30px rgba(0,0,0,.35);
      --radius:16px;
      --card-border: rgba(255,255,255,.08);
      --card-grad1: rgba(255,255,255,.04);
      --card-grad2: rgba(255,255,255,.02);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:'Inter',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background: radial-gradient(1200px 800px at 10% -10%, #1d2955, transparent 60%), radial-gradient(800px 600px at 120% 10%, #1a3a6e, transparent 50%), var(--bg);
      color:var(--text);
    }
    .app{
      max-width:100%;
      margin:0;
      padding:20px;
    }
    .header{
      text-align:center;
      margin-bottom:24px;
    }
    .title{
      font-weight:700;
      font-size:2rem;
      margin:0 0 8px;
    }
    .subtitle{
      color:var(--muted);
      margin:0;
      font-size:1.1rem;
    }

    /* ========== Card Container ========== */
    .card{
      background: linear-gradient(180deg, var(--card-grad1), var(--card-grad2));
      border: 1px solid var(--card-border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      padding: 20px 20px 30px;
      backdrop-filter: blur(6px);
      max-width: 1400px;
      margin: 0 auto;
    }

    /* ========== Sections ========== */
    .section{padding: 16px}
    .section-title{margin:8px 6px 16px;font-size:1.3rem;font-weight:600}

    /* ========== Form ========== */
    form{display:block}
    .fieldset{
      border:1px dashed rgba(255,255,255,.12);
      border-radius:12px;
      padding:16px 16px 12px;
      margin: 12px 6px 18px;
    }
    .legend{
      padding:0 8px;
      color:var(--muted);
      font-size:.95rem;
    }
    .row{
      display:grid;
      grid-template-columns:repeat(4, 1fr);
      gap:16px;
      margin:12px 6px;
    }
    .row.three{grid-template-columns:repeat(3,1fr)}
    .row.single{grid-template-columns:1fr}
    .field{display:block}
    .label{
      display:flex;
      justify-content:space-between;
      align-items:center;
      margin:0 0 8px;
      color:var(--muted);
      font-size:1rem;
    }
    .error{color:var(--danger);font-size:.9rem;min-height:20px}
    .input, .select{
      width:100%;
      padding:14px 16px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(2,6,23,.6);
      color:var(--text);
      outline:none;
      transition:border-color .2s, box-shadow .2s;
      font-size:1rem;
    }
    .input:focus, .select:focus{
      border-color:rgba(99,102,241,.6);
      box-shadow:0 0 0 4px rgba(99,102,241,.15)
    }
    .radio{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin:0 16px 10px 0;
      cursor:pointer;
      font-size:1rem;
    }
    .radio input{accent-color:var(--primary)}
    .units-inline{display:flex;gap:20px;flex-wrap:wrap}
    .hint{color:var(--muted);font-size:.9rem}

    /* ========== Buttons ========== */
    .actions{
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      margin: 16px 6px 0;
    }
    .btn{
      appearance:none;
      border:none;
      border-radius:12px;
      padding:14px 20px;
      font-weight:600;
      cursor:pointer;
      font-size:1rem;
      transition:transform .08s, background .2s, box-shadow .2s
    }
    .btn:active{transform:translateY(1px) scale(.99)}
    .btn.primary{
      background:linear-gradient(180deg, var(--primary), var(--primary-600));
      color:white;
      box-shadow:0 8px 18px rgba(99,102,241,.35)
    }
    .btn.primary:hover{filter:brightness(1.05)}
    .btn.ghost{
      background:rgba(255,255,255,.05);
      color:var(--text);
      border:1px solid rgba(255,255,255,.12)
    }
    .btn.ghost:hover{background:rgba(255,255,255,.09)}

    /* ========== Results ========== */
    .results{
      display:none;
      opacity:0;
      transform:translateY(8px);
      transition:opacity .25s ease, transform .25s ease
    }
    .results.show{
      display:block;
      opacity:1;
      transform:translateY(0)
    }
    .result-card{
      margin: 18px 6px 0;
      padding: 18px;
      border-radius: 14px;
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.08);
    }
    .result-grid{
      display:grid;
      grid-template-columns:repeat(5, 1fr);
      gap:12px;
    }
    .result-item{
      background:rgba(255,255,255,.03);
      border:1px dashed rgba(255,255,255,.08);
      border-radius:12px;
      padding:14px;
    }
    .result-item.highlight{
      border-style:solid;
      border-color:rgba(99,102,241,.6);
      box-shadow:0 8px 20px rgba(99,102,241,.18);
    }
    .result-label{color:var(--muted);font-weight:600;font-size:.95rem}
    .result-value{font-size:1.3rem;font-weight:700;margin-top:6px}
    .result-note{margin:14px 0 0;color:var(--muted);font-size:.95rem}

    /* ========== Food Suggestions ========== */
    .food-suggestions {
      margin-top: 28px;
      display: none;
    }
    .food-suggestions.show {
      display: block;
    }
    .food-category {
      margin-bottom: 24px;
    }
    .food-category-title {
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 14px;
      color: var(--primary);
      border-bottom: 1px solid rgba(255,255,255,.1);
      padding-bottom: 8px;
    }
    .food-items-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 14px;
    }
    .food-item {
      background: rgba(255,255,255,.03);
      border: 1px solid rgba(255,255,255,.08);
      border-radius: 10px;
      padding: 14px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .food-name {
      font-weight: 500;
      font-size: 1rem;
    }
    .food-calories {
      color: var(--muted);
      font-size: .95rem;
    }
    .food-serving {
      color: var(--muted);
      font-size: .9rem;
      margin-top: 4px;
    }
    .food-diet-badge {
      display: inline-block;
      padding: 3px 10px;
      border-radius: 10px;
      font-size: .8rem;
      font-weight: 600;
      margin-left: 8px;
    }
    .veg {
      background: rgba(34, 197, 94, 0.2);
      color: #22c55e;
    }
    .non-veg {
      background: rgba(239, 68, 68, 0.2);
      color: #ef4444;
    }

    .footer{
      text-align:center;
      color:var(--muted);
      font-size:.9rem;
      margin-top:20px;
    }

    /* Responsive */
    @media (max-width: 1200px) {
      .row { grid-template-columns: repeat(3, 1fr); }
      .result-grid { grid-template-columns: repeat(3, 1fr); }
    }
    
    @media (max-width: 900px){
      .row{grid-template-columns:1fr 1fr}
      .row.three{grid-template-columns:1fr 1fr}
      .result-grid{grid-template-columns:1fr 1fr}
    }
    
    @media (max-width:720px){
      .row{grid-template-columns:1fr}
      .row.three{grid-template-columns:1fr}
      .result-grid{grid-template-columns:1fr}
      .food-items-grid { grid-template-columns: 1fr; }
    }
    
    @media (max-width:420px){
      .app { padding: 12px; }
      .input,.select{padding:12px 14px}
      .btn { padding: 12px 16px; }
    }
  </style>
</head>
<body>
  <main class="app">
    <header class="header">
      <h1 class="title">Indian Food Calorie Needs Calculator</h1>
      <p class="subtitle">Estimate calories and get personalized Indian food recommendations</p>
    </header>

    <section class="card">
      <!-- Input Form -->
      <section id="form-section" class="section">
        <h2 class="section-title">Your Details</h2>

        <form id="calorie-form" novalidate>
          <div class="row">
            <!-- Units -->
            <div class="field">
              <fieldset class="fieldset">
                <legend class="legend">Units</legend>
                <div class="units-inline">
                  <label class="radio">
                    <input type="radio" name="units" value="metric" checked>
                    <span>Metric (kg, cm)</span>
                  </label>
                  <label class="radio">
                    <input type="radio" name="units" value="imperial">
                    <span>Imperial (lb, ft/in)</span>
                  </label>
                </div>
                <p class="hint">Switching units will update input labels automatically.</p>
              </fieldset>
            </div>

            <!-- Gender -->
            <div class="field">
              <fieldset class="fieldset">
                <legend class="legend">Gender</legend>
                <div class="units-inline">
                  <label class="radio">
                    <input type="radio" name="gender" value="male" checked>
                    <span>Male</span>
                  </label>
                  <label class="radio">
                    <input type="radio" name="gender" value="female">
                    <span>Female</span>
                  </label>
                </div>
              </fieldset>
            </div>

            <!-- Dietary Preference -->
            <div class="field">
              <fieldset class="fieldset">
                <legend class="legend">Dietary Preference</legend>
                <div class="units-inline">
                  <label class="radio">
                    <input type="radio" name="diet" value="vegetarian" checked>
                    <span>Vegetarian</span>
                  </label>
                  <label class="radio">
                    <input type="radio" name="diet" value="non-vegetarian">
                    <span>Non-Vegetarian</span>
                  </label>
                </div>
                <p class="hint">This will affect food recommendations.</p>
              </fieldset>
            </div>

            <!-- Age -->
            <div class="field">
              <label for="age" class="label">
                <span>Age (years)</span>
                <span class="error" id="age-error"></span>
              </label>
              <input type="number" id="age" class="input" placeholder="e.g., 30" min="0" step="1" inputmode="numeric">
            </div>
          </div>

          <div class="row">
            <!-- Weight -->
            <div class="field">
              <label for="weight" class="label">
                <span id="weight-label">Weight (kg)</span>
                <span class="error" id="weight-error"></span>
              </label>
              <input type="number" id="weight" class="input" placeholder="e.g., 70" min="0" step="0.1" inputmode="decimal">
            </div>

            <!-- Height -->
            <div class="field" id="height-metric">
              <label for="height-cm" class="label">
                <span id="height-label">Height (cm)</span>
                <span class="error" id="height-error"></span>
              </label>
              <input type="number" id="height-cm" class="input" placeholder="e.g., 170" min="0" step="0.1" inputmode="decimal">
            </div>

            <div class="field" id="height-imperial" style="display:none;">
              <label class="label">
                <span>Height (ft/in)</span>
                <span class="error" id="height-ftin-error"></span>
              </label>
              <div style="display: flex; gap: 10px;">
                <input type="number" id="height-ft" class="input" placeholder="ft" min="0" step="1" inputmode="numeric">
                <input type="number" id="height-in" class="input" placeholder="in" min="0" step="0.1" inputmode="decimal">
              </div>
            </div>

            <!-- Activity -->
            <div class="field">
              <label for="activity" class="label">
                <span>Activity Level</span>
                <span class="error" id="activity-error"></span>
              </label>
              <select id="activity" class="select">
                <option value="">Select activity level</option>
                <option value="1.2">Sedentary (little or no exercise)</option>
                <option value="1.375">Lightly Active (1-3 days/week)</option>
                <option value="1.55">Moderately Active (3-5 days/week)</option>
                <option value="1.725">Very Active (6-7 days/week)</option>
                <option value="1.9">Extra Active (very hard exercise & physical job)</option>
              </select>
            </div>
          </div>

          <!-- Actions -->
          <div class="actions">
            <button type="button" id="calc" class="btn primary">Calculate Calories</button>
            <button type="reset" id="clear" class="btn ghost">Clear</button>
          </div>
        </form>
      </section>

      <!-- Results -->
      <section id="results-section" class="section results" aria-live="polite">
        <h2 class="section-title">Daily Calorie Estimates</h2>

        <div class="result-card">
          <div class="result-grid">
            <div class="result-item highlight">
              <div class="result-label">Maintain Weight</div>
              <div class="result-value" id="maintain-val">— kcal/day</div>
            </div>

            <div class="result-item">
              <div class="result-label">Mild Weight Loss (−0.5 lb/week)</div>
              <div class="result-value" id="mild-loss-val">— kcal/day</div>
            </div>

            <div class="result-item">
              <div class="result-label">Weight Loss (−1 lb/week)</div>
              <div class="result-value" id="loss-val">— kcal/day</div>
            </div>

            <div class="result-item">
              <div class="result-label">Mild Weight Gain (+0.5 lb/week)</div>
              <div class="result-value" id="mild-gain-val">— kcal/day</div>
            </div>

            <div class="result-item">
              <div class="result-label">Weight Gain (+1 lb/week)</div>
              <div class="result-value" id="gain-val">— kcal/day</div>
            </div>
          </div>

          <p class="result-note">
            Numbers are estimates based on Mifflin–St Jeor BMR and activity factors. Track progress and adjust as needed.
          </p>

          <!-- Food Suggestions -->
          <div id="food-suggestions" class="food-suggestions">
            <h3 class="section-title">Indian Food Recommendations</h3>
            <div id="food-content">
              <!-- Food items will be populated here by JavaScript -->
            </div>
          </div>

          <div class="actions">
            <button type="button" id="recalc" class="btn primary">Recalculate</button>
            <button type="button" id="reset-all" class="btn ghost">Clear</button>
          </div>
        </div>
      </section>
    </section>

    <footer class="footer">
      <p>Built with semantic HTML, modern CSS, and vanilla JS.</p>
    </footer>
  </main>

  <script>
    // DOM helpers
    const $ = (s, c=document) => c.querySelector(s);
    const $$ = (s, c=document) => Array.from(c.querySelectorAll(s));

    // Elements
    const formSection = $('#form-section');
    const resultsSection = $('#results-section');
    const form = $('#calorie-form');
    const foodSuggestions = $('#food-suggestions');
    const foodContent = $('#food-content');

    const unitRadios = $$('input[name="units"]');
    const genderRadios = $$('input[name="gender"]');
    const dietRadios = $$('input[name="diet"]');

    const ageEl = $('#age');
    const weightEl = $('#weight');
    const heightCmEl = $('#height-cm');
    const heightFtEl = $('#height-ft');
    const heightInEl = $('#height-in');
    const heightMetricGroup = $('#height-metric');
    const heightImperialGroup = $('#height-imperial');
    const weightLabel = $('#weight-label');
    const heightLabel = $('#height-label');
    const activityEl = $('#activity');

    const calcBtn = $('#calc');
    const clearBtn = $('#clear');
    const recalcBtn = $('#recalc');
    const resetAllBtn = $('#reset-all');

    // Error spans
    const ageErr = $('#age-error');
    const weightErr = $('#weight-error');
    const heightErr = $('#height-error');
    const heightFtInErr = $('#height-ftin-error');
    const activityErr = $('#activity-error');

    // Results spans
    const maintainVal = $('#maintain-val');
    const mildLossVal = $('#mild-loss-val');
    const lossVal = $('#loss-val');
    const mildGainVal = $('#mild-gain-val');
    const gainVal = $('#gain-val');

    // Indian Food Database (without beef and pork)
    const foodDatabase = {
      vegetarian: {
        breakfast: [
          { name: "Poha", calories: 250, serving: "1 plate", type: "veg" },
          { name: "Upma", calories: 280, serving: "1 bowl", type: "veg" },
          { name: "Idli with Sambar", calories: 150, serving: "2 pieces", type: "veg" },
          { name: "Dosa with Chutney", calories: 220, serving: "1 piece", type: "veg" },
          { name: "Paratha with Curd", calories: 350, serving: "2 pieces", type: "veg" },
          { name: "Besan Chilla", calories: 200, serving: "2 pieces", type: "veg" },
          { name: "Aloo Paratha", calories: 400, serving: "2 pieces", type: "veg" },
          { name: "Methi Thepla", calories: 180, serving: "2 pieces", type: "veg" },
          { name: "Rava Uttapam", calories: 280, serving: "1 piece", type: "veg" },
          { name: "Sabudana Khichdi", calories: 320, serving: "1 bowl", type: "veg" }
        ],
        lunch: [
          { name: "Dal Tadka with Rice", calories: 450, serving: "1 plate", type: "veg" },
          { name: "Palak Paneer with Roti", calories: 500, serving: "2 rotis", type: "veg" },
          { name: "Vegetable Biryani", calories: 480, serving: "1 plate", type: "veg" },
          { name: "Rajma Chawal", calories: 520, serving: "1 plate", type: "veg" },
          { name: "Chole Bhature", calories: 600, serving: "2 bhaturas", type: "veg" },
          { name: "Baingan Bharta with Roti", calories: 380, serving: "2 rotis", type: "veg" },
          { name: "Malai Kofta with Naan", calories: 550, serving: "2 naans", type: "veg" },
          { name: "Mix Veg with Roti", calories: 420, serving: "2 rotis", type: "veg" },
          { name: "Kadhi Pakoda with Rice", calories: 460, serving: "1 plate", type: "veg" },
          { name: "Aloo Gobi with Paratha", calories: 480, serving: "2 parathas", type: "veg" }
        ],
        dinner: [
          { name: "Vegetable Pulao with Raita", calories: 450, serving: "1 plate", type: "veg" },
          { name: "Dal Makhani with Naan", calories: 520, serving: "2 naans", type: "veg" },
          { name: "Matar Paneer with Roti", calories: 480, serving: "2 rotis", type: "veg" },
          { name: "Vegetable Kofta Curry", calories: 420, serving: "1 bowl", type: "veg" },
          { name: "Bhindi Masala with Roti", calories: 380, serving: "2 rotis", type: "veg" },
          { name: "Mushroom Matar with Rice", calories: 440, serving: "1 plate", type: "veg" },
          { name: "Aloo Matar with Puri", calories: 500, serving: "4 puris", type: "veg" },
          { name: "Gobi Manchurian with Fried Rice", calories: 520, serving: "1 plate", type: "veg" },
          { name: "Paneer Butter Masala with Naan", calories: 580, serving: "2 naans", type: "veg" },
          { name: "Sarson Ka Saag with Makki Roti", calories: 460, serving: "2 rotis", type: "veg" }
        ],
        snacks: [
          { name: "Samosa", calories: 260, serving: "2 pieces", type: "veg" },
          { name: "Pakora", calories: 180, serving: "4 pieces", type: "veg" },
          { name: "Bhel Puri", calories: 200, serving: "1 plate", type: "veg" },
          { name: "Aloo Tikki", calories: 150, serving: "2 pieces", type: "veg" },
          { name: "Pani Puri", calories: 120, serving: "6 pieces", type: "veg" },
          { name: "Masala Dosa", calories: 280, serving: "1 piece", type: "veg" },
          { name: "Pav Bhaji", calories: 350, serving: "2 pav", type: "veg" },
          { name: "Dhokla", calories: 160, serving: "4 pieces", type: "veg" },
          { name: "Kachori", calories: 220, serving: "2 pieces", type: "veg" },
          { name: "Vada Pav", calories: 280, serving: "1 piece", type: "veg" }
        ]
      },
      "non-vegetarian": {
        breakfast: [
          { name: "Egg Bhurji with Toast", calories: 320, serving: "2 eggs + 2 toast", type: "non-veg" },
          { name: "Chicken Sandwich", calories: 380, serving: "1 sandwich", type: "non-veg" },
          { name: "Egg Paratha", calories: 350, serving: "2 pieces", type: "non-veg" },
          { name: "Keema Pav", calories: 420, serving: "2 pav", type: "non-veg" },
          { name: "Chicken Omelette", calories: 280, serving: "2 eggs", type: "non-veg" },
          { name: "Egg Dosa", calories: 300, serving: "1 piece", type: "non-veg" },
          { name: "Chicken Roll", calories: 350, serving: "1 roll", type: "non-veg" },
          { name: "Mutton Kheema Paratha", calories: 480, serving: "2 pieces", type: "non-veg" },
          { name: "Egg Fried Rice", calories: 420, serving: "1 plate", type: "non-veg" },
          { name: "Chicken Poha", calories: 380, serving: "1 plate", type: "non-veg" }
        ],
        lunch: [
          { name: "Butter Chicken with Naan", calories: 650, serving: "2 naans", type: "non-veg" },
          { name: "Chicken Biryani", calories: 580, serving: "1 plate", type: "non-veg" },
          { name: "Fish Curry with Rice", calories: 520, serving: "1 plate", type: "non-veg" },
          { name: "Mutton Rogan Josh with Roti", calories: 620, serving: "2 rotis", type: "non-veg" },
          { name: "Chicken Curry with Rice", calories: 540, serving: "1 plate", type: "non-veg" },
          { name: "Egg Curry with Roti", calories: 480, serving: "2 rotis", type: "non-veg" },
          { name: "Chicken Tikka Masala with Naan", calories: 680, serving: "2 naans", type: "non-veg" },
          { name: "Fish Fry with Dal and Rice", calories: 560, serving: "1 plate", type: "non-veg" },
          { name: "Mutton Curry with Biryani", calories: 720, serving: "1 plate", type: "non-veg" },
          { name: "Chicken Korma with Roti", calories: 580, serving: "2 rotis", type: "non-veg" }
        ],
        dinner: [
          { name: "Tandoori Chicken with Salad", calories: 450, serving: "4 pieces", type: "non-veg" },
          { name: "Chicken Handi with Naan", calories: 620, serving: "2 naans", type: "non-veg" },
          { name: "Mutton Biryani", calories: 680, serving: "1 plate", type: "non-veg" },
          { name: "Fish Biryani", calories: 560, serving: "1 plate", type: "non-veg" },
          { name: "Chicken Kadhai with Roti", calories: 540, serving: "2 rotis", type: "non-veg" },
          { name: "Egg Biryani", calories: 480, serving: "1 plate", type: "non-veg" },
          { name: "Chicken Chettinad with Appam", calories: 580, serving: "2 appams", type: "non-veg" },
          { name: "Mutton Korma with Rice", calories: 620, serving: "1 plate", type: "non-veg" },
          { name: "Chicken 65 with Fried Rice", calories: 520, serving: "1 plate", type: "non-veg" },
          { name: "Butter Prawns with Naan", calories: 580, serving: "2 naans", type: "non-veg" }
        ],
        snacks: [
          { name: "Chicken Tikka", calories: 320, serving: "6 pieces", type: "non-veg" },
          { name: "Egg Roll", calories: 280, serving: "1 roll", type: "non-veg" },
          { name: "Chicken Cutlet", calories: 220, serving: "2 pieces", type: "non-veg" },
          { name: "Fish Pakora", calories: 260, serving: "4 pieces", type: "non-veg" },
          { name: "Chicken Samosa", calories: 180, serving: "2 pieces", type: "non-veg" },
          { name: "Mutton Kebab", calories: 300, serving: "4 pieces", type: "non-veg" },
          { name: "Egg Pakora", calories: 200, serving: "4 pieces", type: "non-veg" },
          { name: "Chicken Lollipop", calories: 280, serving: "4 pieces", type: "non-veg" },
          { name: "Fish Finger", calories: 240, serving: "6 pieces", type: "non-veg" },
          { name: "Chicken Spring Roll", calories: 320, serving: "2 pieces", type: "non-veg" }
        ]
      }
    };

    // Unit switching
    const updateUnits = () => {
      const unit = ($('input[name="units"]:checked')||{}).value || 'metric';
      if (unit === 'metric') {
        weightLabel.textContent = 'Weight (kg)';
        heightLabel.textContent = 'Height (cm)';
        heightMetricGroup.style.display = '';
        heightImperialGroup.style.display = 'none';
        // clear imperial height inputs
        heightFtEl.value = '';
        heightInEl.value = '';
      } else {
        weightLabel.textContent = 'Weight (lb)';
        heightLabel.textContent = 'Height';
        heightMetricGroup.style.display = 'none';
        heightImperialGroup.style.display = '';
        // clear metric height inputs
        heightCmEl.value = '';
      }
      clearErrors();
    };
    unitRadios.forEach(r => r.addEventListener('change', updateUnits));

    // Clear error messages
    const clearErrors = () => {
      [ageErr, weightErr, heightErr, heightFtInErr, activityErr].forEach(el => el.textContent = '');
    };

    // Validation helpers
    const isPositive = v => typeof v === 'number' && isFinite(v) && v > 0;

    const readInputs = () => {
      const units = ($('input[name="units"]:checked')||{}).value || 'metric';
      const gender = ($('input[name="gender"]:checked')||{}).value || 'male';
      const diet = ($('input[name="diet"]:checked')||{}).value || 'vegetarian';
      const age = parseFloat(ageEl.value);
      const weight = parseFloat(weightEl.value);
      let heightCm = null;

      clearErrors();
      let valid = true;

      if (!isPositive(age)) {
        ageErr.textContent = 'Enter a valid age.';
        valid = false;
      }
      if (!isPositive(weight)) {
        weightErr.textContent = 'Enter a valid weight.';
        valid = false;
      }

      if (units === 'metric') {
        const cm = parseFloat(heightCmEl.value);
        if (!isPositive(cm)) {
          heightErr.textContent = 'Enter a valid height in cm.';
          valid = false;
        } else {
          heightCm = cm;
        }
      } else {
        const ft = parseFloat(heightFtEl.value);
        const inch = parseFloat(heightInEl.value);
        const hasFt = isFinite(ft) && ft >= 0;
        const hasIn = isFinite(inch) && inch >= 0;
        if (!hasFt || !hasIn || (ft === 0 && inch === 0)) {
          heightFtInErr.textContent = 'Enter feet and inches (at least one positive).';
          valid = false;
        } else {
          const totalIn = (ft * 12) + inch;
          heightCm = totalIn * 2.54; // convert inches to cm
        }
      }

      if (!activityEl.value) {
        activityErr.textContent = 'Select activity level.';
        valid = false;
      }

      // Convert weight to kg if imperial
      let weightKg = weight;
      if (units === 'imperial' && isPositive(weight)) {
        weightKg = weight * 0.45359237;
      }

      return {
        valid, units, gender, diet, age, weightKg, heightCm, activityFactor: parseFloat(activityEl.value || '0')
      };
    };

    // Mifflin–St Jeor BMR
    const bmrMifflin = ({gender, weightKg, heightCm, age}) => {
      const base = 10 * weightKg + 6.25 * heightCm - 5 * age;
      return gender === 'male' ? base + 5 : base - 161;
    };

    // TDEE
    const calcTDEE = (bmr, activityFactor) => bmr * activityFactor;

    // Format kcal
    const fmt = n => `${Math.round(n).toLocaleString()} kcal/day`;

    // Shuffle array and get random items
    const getRandomFoods = (foods, count) => {
      const shuffled = [...foods].sort(() => 0.5 - Math.random());
      return shuffled.slice(0, count);
    };

    // Generate food suggestions
    const generateFoodSuggestions = (targetCalories, dietType) => {
      const dietFoods = foodDatabase[dietType];
      let html = '';
      
      // Calculate target calories per meal (rough estimate)
      const breakfastTarget = targetCalories * 0.25; // 25% for breakfast
      const lunchTarget = targetCalories * 0.35;     // 35% for lunch
      const dinnerTarget = targetCalories * 0.30;    // 30% for dinner
      const snacksTarget = targetCalories * 0.10;    // 10% for snacks
      
      // Generate suggestions for each meal category
      for (const [category, target] of [
        ['breakfast', breakfastTarget],
        ['lunch', lunchTarget],
        ['dinner', dinnerTarget],
        ['snacks', snacksTarget]
      ]) {
        // Get 4 random food items for this category
        const randomFoods = getRandomFoods(dietFoods[category], 4);
        
        html += `
          <div class="food-category">
            <div class="food-category-title">${category.charAt(0).toUpperCase() + category.slice(1)} (Target: ~${Math.round(target)} kcal)</div>
            <div class="food-items-grid">
        `;
        
        randomFoods.forEach(food => {
          html += `
            <div class="food-item">
              <div>
                <div class="food-name">
                  ${food.name}
                  <span class="food-diet-badge ${food.type}">${food.type === 'veg' ? 'VEG' : 'NON-VEG'}</span>
                </div>
                <div class="food-serving">${food.serving}</div>
              </div>
              <div class="food-calories">${food.calories} kcal</div>
            </div>
          `;
        });
        
        html += `</div></div>`;
      }
      
      return html;
    };

    // Compute pipeline
    const compute = () => {
      const data = readInputs();
      if (!data.valid) return null;
      const bmr = bmrMifflin(data);
      const tdee = calcTDEE(bmr, data.activityFactor);
      return {
        tdee,
        mildLoss: tdee - 250,
        loss: tdee - 500,
        mildGain: tdee + 250,
        gain: tdee + 500,
        diet: data.diet
      };
    };

    // Show results
    const showResults = (res) => {
      if (!res) return;
      maintainVal.textContent = fmt(res.tdee);
      mildLossVal.textContent = fmt(res.mildLoss);
      lossVal.textContent = fmt(res.loss);
      mildGainVal.textContent = fmt(res.mildGain);
      gainVal.textContent = fmt(res.gain);

      // Generate and display food suggestions for maintenance calories
      foodContent.innerHTML = generateFoodSuggestions(res.tdee, res.diet);
      foodSuggestions.classList.add('show');

      formSection.style.display = 'none';
      resultsSection.classList.add('show');
    };

    // Back to form
    const showForm = () => {
      resultsSection.classList.remove('show');
      foodSuggestions.classList.remove('show');
      // allow CSS transition end then display form
      setTimeout(() => { formSection.style.display = ''; }, 200);
    };

    // Actions
    calcBtn.addEventListener('click', () => {
      const res = compute();
      if (res) showResults(res);
    });

    clearBtn.addEventListener('click', () => {
      clearErrors();
    });

    recalcBtn.addEventListener('click', () => {
      showForm();
    });

    resetAllBtn.addEventListener('click', () => {
      form.reset();
      updateUnits();
      clearErrors();
      showForm();
      // Clear results display
      [maintainVal, mildLossVal, lossVal, mildGainVal, gainVal].forEach(el => el.textContent = '— kcal/day');
    });

    // Initialize
    updateUnits();
  </script>
</body>
</html>
